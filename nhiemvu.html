<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Heart Flame FINAL</title>

<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#fff;
}

.wrapper{
  position:relative;
  width:420px;
  height:380px;
}

svg{width:100%;height:100%}

.heart{
  fill:red;
  transform-origin:center;
  animation:beat 1.2s infinite;
}

@keyframes beat{
  0%{transform:scale(1)}
  30%{transform:scale(1.06)}
  60%{transform:scale(1)}
}

.center{
  position:absolute;
  top:55%;
  left:50%;
  transform:translate(-50%,-50%);
  width:100px;
  height:100px;
  background:#fff;
  border-radius:50%;
  z-index:5;
  text-align:center;
  padding-top:25px;
}

.days{color:red;font-size:18px;font-weight:bold}
.time{color:red;font-size:14px}

canvas{
  position:absolute;
  inset:0;
  z-index:4;
  pointer-events:none;
}
</style>
</head>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="theme-color" content="#ff0000">


<body>

<div class="wrapper">

<svg viewBox="0 0 420 380">
  <path id="heartPath" class="heart"
    d="M210 360
       C 20 200, 60 40, 210 120
       C 360 40, 400 200, 210 360 Z"/>
</svg>

<canvas id="fire" width="420" height="380"></canvas>

<div class="center">
  <div class="days" id="days"></div>
  <div class="time" id="time"></div>
</div>

</div>

<script>
/* ===== TIME ===== */
const start=new Date("2024-08-17T00:00:00");
function tick(){
 let d=(Date.now()-start)/1000|0;
 const day=d/86400|0; d%=86400;
 const h=d/3600|0; d%=3600;
 const m=d/60|0; const s=d%60;
 days.textContent=day+" DAY";
 time.textContent=
  `${h.toString().padStart(2,0)}:${m.toString().padStart(2,0)}:${s.toString().padStart(2,0)}`;
}
setInterval(tick,1000); tick();

/* ===== CANVAS ===== */
const c=document.getElementById("fire");
const ctx=c.getContext("2d");
ctx.globalCompositeOperation="lighter";

const svgPath=document.getElementById("heartPath");
const len=svgPath.getTotalLength();

/* ===== FLAME ===== */
function flame(x,y,h,wind){
 ctx.beginPath();
 ctx.moveTo(x,y);
 for(let i=0;i<h;i+=6){
  ctx.lineTo(
    x + Math.sin(i/15 + performance.now()/1200)*wind,
    y - i
  );
 }
 ctx.closePath();

 const g=ctx.createLinearGradient(0,y,0,y-h);
 g.addColorStop(0,"rgba(255,255,200,.9)");
 g.addColorStop(.4,"rgba(255,160,0,.7)");
 g.addColorStop(.7,"rgba(255,80,0,.4)");
 g.addColorStop(1,"rgba(255,0,0,0)");
 ctx.fillStyle=g;
 ctx.fill();
}

function animate(){
 ctx.clearRect(0,0,420,380);

 const t=performance.now()/1000;
 const beat=1+Math.sin(t*2)*0.25;
 const wind=Math.sin(t)*6;

 ctx.save();
 ctx.beginPath();
 ctx.clip(new Path2D(svgPath.getAttribute("d")));

 for(let i=0;i<70;i++){
  const p=svgPath.getPointAtLength((i/70)*len);
  flame(p.x,p.y,35*beat,wind);
 }

 ctx.restore();
 requestAnimationFrame(animate);
}
animate();
</script>

</body>
</html>
